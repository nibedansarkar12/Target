<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Panel - Target Zone</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/jspdf"></script>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body {
      background: linear-gradient(120deg, #a1c4fd, #c2e9fb);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .card {
      background-color: white;
      border-radius: 20px;
      padding: 1.5rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    .icon {
      color: #4f46e5;
    }
  </style>
</head>
<body class="p-6">
  <header class="text-center mb-6">
    <h1 class="text-3xl font-bold text-gray-800">üéØ Admin Dashboard - Target Zone</h1>
    <p class="text-gray-600">Manage your mock tests smartly</p>
  </header>

  <main class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Add Question Card -->
    <div class="card">
      <h2 class="text-xl font-semibold mb-2">‚ûï Add Question</h2>
      <form id="questionForm">
        <input type="text" id="questionText" placeholder="Enter Question" class="w-full mb-2 p-2 border rounded" required>
        <div class="grid grid-cols-2 gap-2 mb-2">
          <input type="text" id="optionA" placeholder="Option A" class="p-2 border rounded" required>
          <input type="text" id="optionB" placeholder="Option B" class="p-2 border rounded" required>
          <input type="text" id="optionC" placeholder="Option C" class="p-2 border rounded" required>
          <input type="text" id="optionD" placeholder="Option D" class="p-2 border rounded" required>
        </div>
        <select id="correctOption" class="w-full mb-2 p-2 border rounded" required>
          <option value="">Correct Option</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
        </select>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Add</button>
      </form>
    </div>

    <!-- Export PDF -->
    <div class="card">
      <h2 class="text-xl font-semibold mb-2">üìÑ Export Questions as PDF</h2>
      <button onclick="generatePDF()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Download PDF</button>
    </div>

    <!-- Clear Login -->
    <div class="card">
      <h2 class="text-xl font-semibold mb-2">üóëÔ∏è Clear All Student Logins</h2>
      <button onclick="clearLogins()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">Clear Logins</button>
    </div>

    <!-- View Results (Placeholder) -->
    <div class="card col-span-1 md:col-span-2 lg:col-span-3">
      <h2 class="text-xl font-semibold mb-2">üìä View Results (Grouped by Test)</h2>
      <div id="resultsContainer" class="space-y-4">
        <p>Coming soon...</p>
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script>
    // ‚úÖ Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyDgJ-FQWMIbmNFi-m0XbZzLzrLU13F5v84",
      authDomain: "mocktest-dichvhi.firebaseapp.com",
      projectId: "mocktest-dichvhi",
      storageBucket: "mocktest-dichvhi.appspot.com",
      messagingSenderId: "425345275542",
      appId: "1:425345275542:web:01a9d12ff9e010ee306b6a"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ‚úÖ Add Question to Firestore
    document.getElementById('questionForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const question = document.getElementById('questionText').value.trim();
      const optionA = document.getElementById('optionA').value.trim();
      const optionB = document.getElementById('optionB').value.trim();
      const optionC = document.getElementById('optionC').value.trim();
      const optionD = document.getElementById('optionD').value.trim();
      const correctOption = document.getElementById('correctOption').value;

      const options = [optionA, optionB, optionC, optionD];
      const answer = {
        A: optionA,
        B: optionB,
        C: optionC,
        D: optionD
      }[correctOption];

      try {
        const snapshot = await db.collection("questions").get();
        const newId = snapshot.size + 1;

        await db.collection("questions").add({
          id: newId,
          question: question,
          options: options,
          answer: answer
        });

        alert("‚úÖ Question added successfully!");
        document.getElementById('questionForm').reset();
      } catch (error) {
        alert("‚ùå Failed to add question: " + error.message);
      }
    });

    // Export PDF (Dummy Content)
    function generatePDF() {
      const doc = new jsPDF();
      doc.text("Target Zone - Questions PDF", 20, 20);
      doc.text("1. Sample Question\nA. Opt A\nB. Opt B\nC. Opt C\nD. Opt D", 20, 40);
      doc.save("questions.pdf");
    }

    // Clear Login (Demo only)
    function clearLogins() {
      alert("All previous student logins cleared!");
    }
  </script>
</body>
</html>
