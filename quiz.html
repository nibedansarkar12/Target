<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>মক টেস্ট</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h2 id="timer">সময়: 80:00</h2>
    <h3 id="question">লোড হচ্ছে...</h3>
    <ul id="options"></ul>

    <div class="navigation">
      <button onclick="prevQuestion()">← পূর্ববর্তী</button>
      <button onclick="nextQuestion()">পরবর্তী →</button>
    </div>

    <button onclick="submitExam()" class="submit-btn">পরীক্ষা জমা দিন</button>
  </div>

  <script>
    let questions = JSON.parse(localStorage.getItem('questions')) || [];
    let answers = JSON.parse(localStorage.getItem('answers')) || [];
    let currentIndex = parseInt(localStorage.getItem('currentIndex')) || 0;

    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");

    function loadQuestion() {
      const q = questions[currentIndex];
      questionEl.textContent = `প্রশ্ন ${currentIndex + 1}: ${q.question}`;
      optionsEl.innerHTML = "";

      q.options.forEach((opt, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <label>
            <input type="radio" name="option" value="${i}" ${answers[currentIndex] == i ? 'checked' : ''} />
            ${opt}
          </label>
        `;
        optionsEl.appendChild(li);
      });
    }

    function saveAnswer() {
      const selected = document.querySelector('input[name="option"]:checked');
      if (selected) {
        answers[currentIndex] = parseInt(selected.value);
        localStorage.setItem('answers', JSON.stringify(answers));
      }
    }

    function nextQuestion() {
      saveAnswer();
      if (currentIndex < questions.length - 1) {
        currentIndex++;
        localStorage.setItem('currentIndex', currentIndex);
        loadQuestion();
      }
    }

    function prevQuestion() {
      saveAnswer();
      if (currentIndex > 0) {
        currentIndex--;
        localStorage.setItem('currentIndex', currentIndex);
        loadQuestion();
      }
    }

    function submitExam() {
      saveAnswer();
      localStorage.setItem('answers', JSON.stringify(answers));
      window.location.href = "result.html";
    }

    function startTimer(duration) {
      let timer = duration, minutes, seconds;
      const timerEl = document.getElementById('timer');
      const countdown = setInterval(function () {
        minutes = parseInt(timer / 60, 10);
        seconds = parseInt(timer % 60, 10);
        timerEl.textContent = `সময়: ${minutes}:${seconds < 10 ? "0" + seconds : seconds}`;

        if (--timer < 0) {
          clearInterval(countdown);
          alert("সময় শেষ!");
          submitExam();
        }
      }, 1000);
    }

    window.onload = () => {
      if (!questions.length) {
        alert("প্রশ্ন পাওয়া যায়নি!");
        return;
      }
      loadQuestion();
      startTimer(80 * 60); // 80 মিনিট
    };
  </script>
</body>
</html>
